
  function [onsetsc,onsetrc]=changepoint(LRP)
% LRP=[0.161658400000000,0.135741200000000,0.107958400000000,0.0785248000000000,0.0469355999999998,0.0117208000000003,-0.0290639999999998,-0.0764927999999998,-0.129526400000000,-0.185653600000000,-0.241656800000000,-0.293006000000000,-0.333065200000000,-0.354029200000000,-0.348621600000000,-0.311278400000000,-0.238952400000000,-0.132165200000000,0.00318120000000005,0.154253200000000,0.301921200000000,0.425025600000000,0.506068400000000,0.535633200000000,0.513538800000001,0.447189200000000,0.348721200000000,0.231679600000000,0.108922800000000,-0.00839720000000005,-0.111064000000000,-0.192352800000000,-0.249119600000000,-0.283239600000000,-0.301056800000000,-0.310398400000000,-0.317020000000000,-0.323250400000000,-0.328471200000000,-0.330831600000000,-0.329132400000000,-0.323838800000000,-0.316669600000000,-0.309845200000000,-0.305689200000000,-0.306291200000000,-0.312683200000000,-0.323736400000000,-0.336990000000000,-0.350400800000000,-0.362828800000000,-0.373512800000000,-0.381895200000000,-0.388241600000000,-0.393947600000000,-0.401062800000000,-0.411393200000000,-0.426050400000000,-0.444609200000000,-0.464341600000000,-0.480057200000000,-0.485626000000000,-0.475813200000000,-0.447146000000000,-0.397529600000000,-0.325949200000000,-0.233096000000000,-0.121551600000000,0.00397440000000018,0.136466000000000,0.267393200000000,0.389369600000000,0.498587600000000,0.595018800000000,0.679293600000000,0.750020000000001,0.803905600000000,0.838506800000000,0.855038800000000,0.859051200000000,0.858958400000000,0.862526400000000,0.874388400000000,0.895800000000000,0.926021200000000,0.962166800000001,0.998337200000000,1.02596040000000,1.03673000000000,1.02536400000000,0.989573600000000,0.928646000000000,0.843410000000000,0.737178000000000,0.616670800000000,0.490800400000000,0.368364800000000,0.255919600000000,0.157282799999999,0.0738476000000002,0.00451439999999970,-0.0548144000000002,-0.110301600000000,-0.168092000000000,-0.232215999999999,-0.304210400000000,-0.383050400000000,-0.466190800000000,-0.551588000000000,-0.639330000000001,-0.731378000000000,-0.828865600000000,-0.929713600000000,-1.02785800000000,-1.11497440000000,-1.18242920000000,-1.22254080000000,-1.22960520000000,-1.20143080000000,-1.14074000000000,-1.05500800000000,-0.954233999999999,-0.848122000000000,-0.745006400000000,-0.652664000000000,-0.578726000000000,-0.529269200000000,-0.507046400000000,-0.510654000000000,-0.534357200000000,-0.568253600000000,-0.599467200000000,-0.615067200000000,-0.605031600000000,-0.564319600000000,-0.493032800000000,-0.395593200000000,-0.278610000000000,-0.149239200000000,-0.0150983999999998,0.114804000000000,0.229788800000000,0.319453600000000,0.376773600000000,0.400229600000000,0.393913200000000,0.366200400000000,0.328491600000000,0.293146400000000,0.271178800000000,0.269798800000001,0.292133200000000,0.338246799999999,0.405991200000000,0.490577600000000,0.584359199999999,0.677685599999999,0.760152800000000,0.821598000000001,0.853810000000000,0.852702800000001,0.819976800000000,0.763381200000001,0.694913200000001,0.627874399999999,0.574202400000000,0.542577600000000,0.537252799999999,0.557908400000000,0.600365999999999,0.657661600000000,0.720661600000000,0.779019999999999,0.822103600000000,0.839830000000000,0.824153999999999,0.771784000000000,0.686083999999999,0.576790000000000,0.457735600000001,0.343980799999999,0.248206000000002,0.177830400000000,0.133861200000000,0.112368400000000,0.107314000000001,0.113085200000000,0.126000400000000,0.144243600000000,0.165643599999999,0.185671600000001,0.198288000000000,0.199290400000000,0.188458800000000,0.169283200000000,0.147224800000000,0.127605600000000,0.114312000000000,0.110416400000000,0.119342400000000,0.145878400000000,0.195397600000000,0.271301200000000,0.372208400000000,0.491099600000000,0.616621600000000,0.736607600000000,0.842226000000000,0.930997200000001,1.00603200000000,1.07340720000000,1.14004000000000,1.21260080000000,1.29663040000000,1.39531480000000,1.50898080000000,1.63581000000000,1.77322480000000,1.91810280000000,2.06583720000000,2.20967600000000,2.34270960000000,2.46094720000000,2.56483400000000,2.65752840000000,2.74292360000000,2.82530680000000,2.90979800000000,3.00194040000000,3.10641760000000,3.22559320000000,3.35803560000000,3.49785520000000,3.63569840000000,3.76137480000000,3.86655600000000,3.94622080000000,3.99893200000000,4.02738840000000,4.03858800000000,4.04231640000000,4.04885800000000,4.06732320000000,4.10484640000000,4.16553320000000,4.25014600000000,4.35656160000000,4.47981480000000,4.61225720000000,4.74529560000000,4.87235560000000,4.99039960000000,5.09889760000000,5.19799480000000,5.28794760000000,5.36943440000000,5.44407600000000,5.51407720000000,5.58170440000000,5.64967120000000,5.72165440000000,5.80110240000000,5.88885400000000,5.98172080000000,6.07360280000000,6.15745080000000,6.22722480000000,6.27946880000000,6.31415640000000,6.33398640000000,6.34325080000000,6.34715120000000,6.35117920000000,6.36032600000000,6.37803640000000,6.40467800000001,6.43653080000000,6.46635120000000,6.48639120000000,6.49109240000000;]
[maxx,ss]=max(LRP);
Y=roundn(LRP(1,1:ss),-2)';
n=length(Y)-1;
t = 0:2:2*n;
X=t/(2*n);
% [onset]=regression(LRP,X);%regression method
d=1:1:length(X);
n=length(X);
gg=zeros(1,n-2);
for I=180:230
[gg(1,I)]=find_g(X,Y,I,2);
end
[min_g,index]=min(gg(1,2:length(gg)-2))
onsetsc=t(1,index)
onsetrc=t(1,length(LRP)-index-1)
hold on
plot(d,X,'r.')
plot(Y,'k*')
plot(gg)